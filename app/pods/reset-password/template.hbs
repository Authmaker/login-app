<div class="account col-xs-10 col-sm-5 center-block">
  <form class="spacing-bottom6">
    <div {{bind-attr class=":form-group :has-feedback errors.email.length:has-error"}}>
      <label class="sr-only" for="email">{{t 'label.email'}}</label>
      <input class="form-control large" type="email" id="email" name="email" placeholder="Email">
      <span {{bind-attr class=":form-control-feedback errors.email.length:show::hide"}}>
        <i class="fa fa-times"></i>
      </span>
    </div>
    <div>
      <input type="hidden" id="client_id" name="client_id" value="escaped_query.client_id">
      <input type="hidden" id="redirect_uri" name="redirect_uri" value="escaped_query.redirect_uri">
      <input type="hidden" id="scope" name="scope" value="escaped_query.scope">
    </div>
    <button class="btn pop blue block" {{action 'resetPassword'}}><span>{{t 'button.reset'}}</span></button>
  </form>
  <div class="text-center">
    <a class="btn hollow" href="#">{{t 'button.signIn'}}</a>
  </div>
</div>

<script type="text/javascript">
$(function(){
  function submit(){
    var email = $("#email").val();
    var client_id = $("#client_id").val();
    var redirect_uri = $("#redirect_uri").val();
    var scope = $("#scope").val();

    //send the post via ajax
    if(!validateExists(email, "Email is required", ".forgotPasswordError")) return false;

    $.ajax({
      type: "POST",
      url: "/reset_password",
      data: {
        email: email,
        client_id: client_id,
        redirect_uri: redirect_uri,
        scope: scope
      },
      success: function(msg) {
        showInfo("Reset email sent successfully, please check your inbox for more instructions.");
      },
      error: function(xhr, textStatus, errorThrown) {

        showError(xhr.responseText);
      }
    });
  }
  $('#submit_form').click(function(){
    submit();

  })

  $('#email').keypress(function(e){
    if(e.which == 13){
      submit();
    }
  });
})

</script>
